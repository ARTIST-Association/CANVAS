<div
  class="d-flex flex-column flex-shrink-0 py-2 border-left m-2 mt-0 bg-body-secondary rounded-3"
  id="sidebar"
>
  <!-- properties -->
  <ul
    class="nav nav-tabs nav-underline px-2 nav-fill mb-auto"
    id="propertiesTab"
    role="tablist"
  >
    <li class="nav-item" role="presentation">
      <button
        class="nav-link active text-reset"
        id="object-tab"
        data-bs-toggle="tab"
        data-bs-target="#object-tab-pane"
        type="button"
        role="tab"
        aria-controls="object-tab-pane"
        aria-selected="true"
      >
        <i class="bi-box me-2"></i>Inspector
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button
        class="nav-link text-reset"
        id="overview-tab"
        data-bs-toggle="tab"
        data-bs-target="#overview-tab-pane"
        type="button"
        role="tab"
        aria-controls="overview-tab-pane"
        aria-selected="true"
      >
        <i class="bi-projector me-2"></i>Overview
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button
        class="nav-link text-reset"
        id="project-tab"
        data-bs-toggle="tab"
        data-bs-target="#project-tab-pane"
        type="button"
        role="tab"
        aria-controls="project-tab-pane"
        aria-selected="true"
      >
        <i class="bi-kanban me-2"></i>Project
      </button>
    </li>
  </ul>
  <div id="content" class="overflow-auto d-flex flex-fill flex-grow-1 w-100">
    <div class="tab-content h-100 w-100 p-2" id="myTabContent">
      <!--Inspector-->
      {% include "editor/sidebar/inspector.html" %}
      <!--Item overview-->
      {% include "editor/sidebar/itemOverview.html" %}
      <!--Project settings-->
      {% include "editor/sidebar/projectSettings.html" %}
    </div>
  </div>
  <div id="settings" class="pb-3 pt-2">
    <hr class="m-0" />
  </div>
  <div class="dropup d-flex justify-content-between mx-3 py-1">
    <!-- Job interface overview toggle -->
    <button
      class="btn btn-primary custom-btn text-reset fs-3 position-relative p-0 px-1 rounded-3"
      data-bs-toggle="modal"
      data-bs-target="#jobInterface"
      id="jobInterfaceToggle"
      title="Current Jobs"
    >
      <div id="hasActiveJobsIndicator" class="d-none">
        <span
          class="position-absolute top-0 start-100 translate-middle bg-danger bg-opacity-50 rounded-circle"
          style="padding: 0.7rem"
        >
          <span class="visually-hidden">New alerts</span>
        </span>
        <span
          class="position-absolute top-0 start-100 translate-middle bg-danger rounded-circle"
          style="padding: 0.3rem"
        >
          <span class="visually-hidden">New alerts</span>
        </span>
      </div>
      <i class="bi bi-list-ul p-1"></i>
    </button>

    <!-- user settings-->
    {% include "userDropdown.html" %}
  </div>
</div>
<script>
  {
    // fix the size of the inspector pane to prevent overflowing (open for better solutions)
    const content = document.getElementById("content");
    const tab = document.getElementById("propertiesTab");
    const userSettings = document.getElementById("settings");
    const calculateMaxHeight = () => {
      const tabRect = tab.getBoundingClientRect();
      const userSettingsRect = userSettings.getBoundingClientRect();

      let maxHeight = tabRect.bottom - userSettingsRect.top;
      maxHeight = Math.abs(maxHeight);
      content.style.height = maxHeight + "px";
    };

    window.addEventListener("resize", calculateMaxHeight);
    document.addEventListener("DOMContentLoaded", calculateMaxHeight);
  }
</script>
